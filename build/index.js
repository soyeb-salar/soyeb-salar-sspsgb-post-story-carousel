(()=>{"use strict";var e,t={791:()=>{const e=window.React,t=window.wp.i18n,a=window.wp.blockEditor,n=window.wp.components,o=window.wp.element,s=[{color:"#000000",name:"Black"},{color:"#FFFFFF",name:"White"},{color:"#FF0000",name:"Red"}];function l(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}wp.blocks.registerBlockType("sspsgb/post-carousel",{title:(0,t.__)("Post Story Carousel","sspsgb"),icon:"slides",category:"layout",attributes:{numberOfPosts:{type:"number",default:7},postType:{type:"string",default:"posts"},category:{type:"string",default:""},fontSize:{type:"number",default:14},fontFamily:{type:"string",default:"Arial"},fontColor:{type:"string",default:"#ffffff"},lineHeight:{type:"number",default:1},subtitleLength:{type:"number",default:50},paddingTop:{type:"number",default:10},paddingBottom:{type:"number",default:10},paddingLeft:{type:"number",default:10},paddingRight:{type:"number",default:10},marginTop:{type:"number",default:10},marginBottom:{type:"number",default:10},marginLeft:{type:"number",default:10},marginRight:{type:"number",default:10},imageSize:{type:"string",default:"large"},customImageWidth:{type:"number",default:175},customImageHeight:{type:"number",default:350},descriptionFontSize:{type:"number",default:12},descriptionFontColor:{type:"string",default:"#ffffff"},cardSpace:{type:"number",default:5}},edit:r=>{const{attributes:i,setAttributes:g}=r,[p,m]=(0,o.useState)([]),[c,u]=(0,o.useState)(!0),[d,b]=(0,o.useState)([]);(0,o.useEffect)((()=>{(async()=>{try{const e=await fetch(`${wpApiSettings.root}wp/v2/types`,{headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!e.ok)throw new Error("Failed to fetch post types");const t=await e.json(),a=Object.keys(t).filter((e=>!["Media","media","page","Page","attachment"].includes(e)&&t[e].icon)).map((e=>({label:t[e].name,value:e})));b(a)}catch(e){console.error("Fetching post types failed:",e)}})()}),[]),(0,o.useEffect)((()=>{(async()=>{u(!0);try{const e=`${wpApiSettings.root}wp/v2/${i.postType}?per_page=${i.numberOfPosts}${i.category?`&categories=${i.category}`:""}`,t=await fetch(e,{headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!t.ok)throw new Error("Network response was not ok.");const a=await t.json(),n=await Promise.all(a.map((async e=>{const t=e.featured_media?await(async e=>{try{const t=await fetch(`${wpApiSettings.root}wp/v2/media/${e}`,{headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!t.ok)throw new Error("Network response was not ok.");return await t.json()}catch(e){return console.error("Fetching media failed:",e),null}})(e.featured_media):null,a=e.author?await(async e=>{try{const t=await fetch(`${wpApiSettings.root}wp/v2/users/${e}`,{headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!t.ok)throw new Error("Network response was not ok.");return await t.json()}catch(e){return console.error("Fetching author details failed:",e),null}})(e.author):null;return{...e,featured_media:t,author:a}})));m(n)}catch(e){console.error("Fetching posts failed:",e)}finally{u(!1)}})()}),[i.numberOfPosts,i.postType,i.category]);const{numberOfPosts:f,postType:h,category:y,fontSize:_,fontFamily:C,fontColor:v,lineHeight:w,subtitleLength:E,paddingTop:S,paddingBottom:F,paddingLeft:x,paddingRight:P,marginTop:T,marginBottom:k,marginLeft:R,marginRight:N,imageSize:O,customImageWidth:$,customImageHeight:B,descriptionFontSize:z,descriptionFontColor:I,cardSpace:L}=i;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:(0,t.__)("Post Settings","sspsgb")},(0,e.createElement)(n.SelectControl,{label:(0,t.__)("Image Size","sspsgb"),value:O,options:[{label:(0,t.__)("Thumbnail","sspsgb"),value:"thumbnail"},{label:(0,t.__)("Medium","sspsgb"),value:"medium"},{label:(0,t.__)("Large","sspsgb"),value:"large"},{label:(0,t.__)("Full","sspsgb"),value:"full"},{label:(0,t.__)("Custom","sspsgb"),value:"custom"}],onChange:e=>g({imageSize:e})}),"custom"===O&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(n.TextControl,{label:(0,t.__)("Custom Image Width (px)","sspsgb"),type:"number",value:$,onChange:e=>g({customImageWidth:parseInt(e,10)||175})}),(0,e.createElement)(n.TextControl,{label:(0,t.__)("Custom Image Height (px)","sspsgb"),type:"number",value:B,onChange:e=>g({customImageHeight:parseInt(e,10)||350})})),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Number of Posts","sspsgb"),value:f,onChange:e=>g({numberOfPosts:e}),min:1,max:20}),(0,e.createElement)(n.SelectControl,{label:(0,t.__)("Post Type","sspsgb"),value:h,options:d,onChange:e=>g({postType:e})}),(0,e.createElement)(n.TextControl,{label:(0,t.__)("Category ID (leave empty for all)","sspsgb"),value:y,onChange:e=>g({category:e})})),(0,e.createElement)(n.PanelBody,{title:(0,t.__)("Title Settings","sspsgb")},(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Title Font Size","sspsgb"),value:_,onChange:e=>g({fontSize:e}),min:10,max:50}),(0,e.createElement)(n.TextControl,{label:(0,t.__)("Title Font Family","sspsgb"),value:C,onChange:e=>g({fontFamily:e})}),(0,e.createElement)(n.ColorPalette,{label:(0,t.__)("Title Font Color","sspsgb"),colors:s,value:v,onChange:e=>g({fontColor:e})}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Title Line Height","sspsgb"),value:w,onChange:e=>g({lineHeight:e}),min:0,max:2})),(0,e.createElement)(n.PanelBody,{title:(0,t.__)("Subtitle Settings","sspsgb")},(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Subtitle Font Size","sspsgb"),value:z,onChange:e=>g({descriptionFontSize:e}),min:10,max:50}),(0,e.createElement)(n.ColorPalette,{label:(0,t.__)("Subtitle Font Color","sspsgb"),colors:s,value:I,onChange:e=>g({descriptionFontColor:e})}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Subtitle Length","sspsgb"),value:E,onChange:e=>g({subtitleLength:e}),min:10,max:200})),(0,e.createElement)(n.PanelBody,{title:(0,t.__)("Spacing Settings","sspsgb")},(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Padding Top","sspsgb"),value:S,onChange:e=>g({paddingTop:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Padding Bottom","sspsgb"),value:F,onChange:e=>g({paddingBottom:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Padding Left","sspsgb"),value:x,onChange:e=>g({paddingLeft:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Padding Right","sspsgb"),value:P,onChange:e=>g({paddingRight:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Margin Top","sspsgb"),value:T,onChange:e=>g({marginTop:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Margin Bottom","sspsgb"),value:k,onChange:e=>g({marginBottom:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Margin Left","sspsgb"),value:R,onChange:e=>g({marginLeft:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Margin Right","sspsgb"),value:N,onChange:e=>g({marginRight:e}),min:0,max:50}),(0,e.createElement)(n.RangeControl,{label:(0,t.__)("Card Space","sspsgb"),value:L,onChange:e=>g({cardSpace:e}),min:0,max:50}))),(0,e.createElement)("div",{...(0,a.useBlockProps)()},c?(0,e.createElement)("div",{className:"post-carousel-loading"},(0,e.createElement)(n.Spinner,null)):p.length>0?(0,e.createElement)("div",{className:"ssspsgb-carousel"},(0,e.createElement)("div",{className:"sspsgb-story-container"},p.map(((t,a)=>{const n=t.featured_media?.source_url||sspsgbpPath+"assets/img/default-story.jpg";return(0,e.createElement)("div",{key:a,className:"sspsgb-story-card",style:{backgroundImage:`url(${n})`,width:`${$}px`,height:`${B}px`,margin:`${L}px`}},(0,e.createElement)("a",{href:t.link,className:"sspsgb-story-info"},t.author&&t.author.avatar_urls&&(0,e.createElement)("img",{className:"sspsgb-user-logo",src:t.author.avatar_urls[24],alt:t.author.name,width:"30",height:"30"}),(0,e.createElement)("div",{className:"sspsgb-story-title",style:{fontSize:`${_}px`,fontFamily:C,color:v,lineHeight:`${w}`}},t.title.rendered)),(0,e.createElement)("div",{className:"sspsgb-story-description",style:{fontSize:`${z}px`,color:I}},l(t.content.rendered).length>E?l(t.content.rendered).substring(0,E)+"...":l(t.content.rendered)))}))),(0,e.createElement)("div",{className:"sspsgb-arrow sspsgb-left"},"‹"),(0,e.createElement)("div",{className:"sspsgb-arrow sspsgb-right"},"›")):(0,e.createElement)("p",null,(0,t.__)("No posts available.","sspsgb"))))},save:()=>null})}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var s=a[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,a,o,s)=>{if(!a){var l=1/0;for(p=0;p<e.length;p++){a=e[p][0],o=e[p][1],s=e[p][2];for(var r=!0,i=0;i<a.length;i++)(!1&s||l>=s)&&Object.keys(n.O).every((e=>n.O[e](a[i])))?a.splice(i--,1):(r=!1,s<l&&(l=s));if(r){e.splice(p--,1);var g=o();void 0!==g&&(t=g)}}return t}s=s||0;for(var p=e.length;p>0&&e[p-1][2]>s;p--)e[p]=e[p-1];e[p]=[a,o,s]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var o,s,l=a[0],r=a[1],i=a[2],g=0;if(l.some((t=>0!==e[t]))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(i)var p=i(n)}for(t&&t(a);g<l.length;g++)s=l[g],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(p)},a=self.webpackChunksspsgb_post_carousel=self.webpackChunksspsgb_post_carousel||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=n.O(void 0,[350],(()=>n(791)));o=n.O(o)})();